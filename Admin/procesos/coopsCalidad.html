<html>
  <head>
    
      <title>COOPERADORES_CALIDAD</title>
    
    
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css"/>
    <link rel="stylesheet" href="https://openlayers.org/en/v5.2.0/css/ol.css" type="text/css"/>    
    <link href="https://paulkinzett.github.io/toolbar/css/jquery.toolbar.css" rel="stylesheet"/> 


    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css"/>    
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>

    <script src="https://cdn.polyfill.io/v2/polyfill.min.js?features=requestAnimationFrame,Element.prototype.classList,URL"></script>
    <script src="https://openlayers.org/en/v4.6.5/build/ol.js"></script>
    

    <script src="https://paulkinzett.github.io/toolbar/js/jquery.toolbar.min.js"></script>
    <script src="../../proj4js_250/dist/proj4.js"></script>
     

    <style>

     /*      table {                

                width: 100%;
                border-collapse: collapse;
            }

            td { 
                padding: 3px 5px;
                text-align: center;
                border: 1px solid #999;
            }

            tr:nth-child(1) {
                border: 1px solid #999;
                background: #dedede;
            }*/

    table {        
     width: 100%;
     border: 1px solid #999;
     text-align: left;
     border-collapse: collapse;
     margin: 0 0 1em 0;
     caption-side: top;
     font-weight: 100;
     font-style: normal;
    }
    caption, td, th {
     padding: 0.3em;     
    }
    th {
      text-align: center;
      background: #dedede;
    }
    td {
      border-bottom: 1px solid #999;
      text-align: center;
      width: 25%;
    }

      a.skiplink {
        position: absolute;
        clip: rect(1px, 1px, 1px, 1px);
        padding: 0;
        border: 0;
        height: 1px;
        width: 1px;
        overflow: hidden;
      }
      a.skiplink:focus {
        clip: auto;
        height: auto;
        width: auto;
        background-color: #fff;
        padding: 0.3em;
      }
      #map:focus {
        outline: #4A74A8 solid 0.15em;
      }

      .ol-popup {
        position: absolute;
        background-color: white;
        -webkit-filter: drop-shadow(0 1px 4px rgba(0,0,0,0.2));
        filter: drop-shadow(0 1px 4px rgba(0,0,0,0.2));
        padding: 15px;
        border-radius: 10px;
        border: 1px solid #cccccc;
        bottom: 12px;
        left: -50px;
        min-width: 50px;
      }
      .ol-popup:after, .ol-popup:before {
        top: 100%;
        border: solid transparent;
        content: " ";
        height: 0;
        width: 0;
        position: absolute;
        pointer-events: none;
      }
      .ol-popup:after {
        border-top-color: white;
        border-width: 10px;
        left: 48px;
        margin-left: -10px;
      }
      .ol-popup:before {
        border-top-color: #cccccc;
        border-width: 11px;
        left: 48px;
        margin-left: -11px;
      }
      .ol-popup-closer {
        text-decoration: none;
        position: absolute;
        top: 2px;
        right: 8px;
      }
      .ol-popup-closer:after {
        content: "✖";
      }
  .letratabla{
      font-size:12px;
  }
      
  .ui-progressbar {
    position: relative;
  }
  .progress-label {
    position: absolute;
    left: 50%;
    top: 4px;
    font-weight: bold;
    text-shadow: 1px 1px 0 #fff;
  }
/*Ventana modal*/
 #boxes .window {  
  font-size:20px;
  position:fixed;
  width:auto;
  height:auto;
  display:none;
  z-index:9999;
  padding:20px;             
}
  
#mask {
  z-index:10;
  background-color:#000;
  display:none;
  position: fixed;    
  left: 0;
  top: 0;  
}

#boxes, #formcoop { 
  width:auto; 
  height:auto;
}

.datos {
   font-size:15px;   
   background:silver;     
   font-weight:bold;   
   border: 3px solid #393939;
   border-radius: 5px 5px 5px 5px;
   color: #393939;   
   padding: 5px; 
}

.posicion_boton_cancelar_coop {
  font-weight: bold;      
  font-size:30px;   
  color:white;  
}

.posicion_boton_accion_coop{
  font-weight: bold;      
  font-size:30px;   
  color:white;  
}

.consultarpred, .copiapeganomcoop .getcoop{
  font-weight: bold;      
  font-size:20px;   
  color:black;  
   }

.datospred {
  font-weight: bold;      
  font-size:15px;   
  color:blue;  
   }

.titulo {
  font-weight: bold;      
  font-size:25px;   
  color:white;         
        }
  </style>
</head>
  <body>
     <a class="skiplink" href="#map">Ir al mapa...</a>
    
   <div id="map" class="map" tabindex="0">
     <div id="popup" class="ol-popup">
         <a href="#" id="popup-closer" class="ol-popup-closer"></a>
         <div id="popup-content"></div>
     </div>    
   </div> 
   <div id="toolbar-options" class="hidden">
      <a href="#" id="altacoop"><i class="fa fa-check"></i></a>
      <a href="#" id="editcoop"><i class="fa fa-edit"></i></a>
      <a href="#" id="elimcoop"><i class="fa fa-trash"></i></a>
      <a href="#" id="infcoop"><i class="fa fa-exclamation-circle"></i></a>
      <a href="#" id="promocion"><i class="fa fa-bolt"></i></a>
   </div>
   <div data-toolbar="toolbar-options" data-toolbar-animation="flip" class="btn-toolbar " style="position:absolute; top:50%; left:0%"  data-toolbar-style="primary" id="button">
   <i class="fa fa-cog" style="position:relative"></i>
   </div>
   <div id="boxes">
     <div id="formcoop" class="window"> 
        <div id="titulocoop" class="titulo" style="text-align:left"> 
           <p style="text-align:center">GESTION  DE  COOPERADORES</p>
           No. de solicitud: <label for="idsol" id="lblsolicitud"></label>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp No. Usuario:<label for="idusu" id="lblusuario"></label><br/>
           No. Factibilidad: <label for="idfact" id="lblfact"></label>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp Acción:<label for="accion" id="lblaccioncoop"></label>
        </div>
        <div class="datos" id="bodycoop">
          <p style="text-align:center">DATOS DEL COOPERADOR</p>
          <label for="name">Personas registradas:</label><select name="NombresReg" id="cmbNombresReg"></select>&nbsp&nbsp&nbsp&nbsp<a href="#" class ="getcoop">>>></a><br/><br/>
          <label for="name">Apellido Paterno:</label><input type="text" name="apaterno" id="apaterno" size="30" style="text-transform:uppercase"/>&nbsp&nbsp<label for="name">Apellido Materno:</label><input type="text" name="amaterno" id="amaterno" size="30" style="text-transform:uppercase"/>&nbsp&nbsp
          <label for="name">Nombre(s):</label><input type="text" name="nombrescoop" id="nombrescoop" size="40"  style="text-transform:uppercase"/>&nbsp&nbsp<a href="#" class ="copiapeganomcoop">>>></a><br/>                         
          <label for="name">*Nombre para ficha de pago:</label><input type="text" name="nomfichacoop" id="nomfichacoop" size="120" style="text-transform:uppercase"/><br/>
          <label for="name">Teléfono:</label><input type="text" name="telcoop" id="telcoop" size="10"/>&nbsp&nbsp&nbsp&nbsp<label for="name">Correo electrónico:</label><input type="text" name="emailcoop" id="emailcoop" size="80"/><br/>
          <label for="name">CURP:</label><input type="text" name="curp" id="curp" size="30"/>&nbsp&nbsp&nbsp<label for="name">Relación con el Predio:</label><select name="relpred" id="lstrelpred"></select><br/>          
          <p style="text-align:left"><label for="name">Domicilio para notificación.</label></p>         
          <label for="name">*Calle:</label><select name="callenotif" id="calle"></select>&nbsp&nbsp&nbsp<label for="name">*Colonia:</label><select name="colnotif" id="colonia"></select>&nbsp&nbsp<label for="name">*No. Oficial:</label><input type="text" name="nooficnotif" id="nooficnotif" size="10"/><br/>                    
          <p style="text-align:center">DATOS DEL PREDIO BENEFICIADO (SISTEMA PREDIAL)</p>
          <label for="name">Cuenta Predial:</label><input type="text" name="ctapred" id="ctapred" size="15"/>  <a href="#" class ="consultarpred">>>></a><br/><br/>          
          <label for="name">Nombre del Propietario:</label>&nbsp&nbsp<label for="nompropietariomunic" id="lblnompropmunic" class ="datospred"></label><br/>                                
          <label for="name">Calle Notific.:</label>&nbsp&nbsp<label for="callempropunic" id="lblcallepropmunic" class ="datospred"></label><br/>
          <label for="name">Colonia Notific.:</label>&nbsp&nbsp<label for="coloniapropmunic" id="lblcoloniamunic" class ="datospred"></label>          
          <p style="text-align:left">Ubicación del Predio</p>            
          <label for="name">Calle y No.:</label>&nbsp&nbsp<label for="municdomprop" id="lblmunicdomprop" class ="datospred"></label><br/>                                
          <label for="name">Colonia:</label>&nbsp&nbsp<label for="municcolprop" id="lblmuniccolprop" class ="datospred"></label><br/>
          <label for="name">Tipo uso de suelo::</label>&nbsp&nbsp<label for="tipousosuelo" id="tipousosuelo" class ="datospred"></label>        
          <p style="text-align:center">REFERENCIAS ADICIONALES AL PREDIO</p>
          <label for="name">*Metros frente:</label><input type="text" name="mtsfte" id="mtsfte" size="6"/>&nbsp&nbsp&nbsp&nbsp<label for="name">*No. Oficial:</label><input type="text" name="nooficial" id="nooficial" size="10"/>&nbsp&nbsp&nbsp&nbsp<label for="name">*Tipo de predio:</label><select name="tipopredio" id="tipopredio"></select><br/>
          <label for="name">Cta. IMUVI:</label><input type="text" name="ctaimuvi" id="ctaimuvi" size="15"/>&nbsp&nbsp&nbsp&nbsp<label for="name">No. medidor SAPAL:</label><input type="text" name="recsapal" id="recsapal" size="10"/>&nbsp&nbsp&nbsp&nbsp<label for="name">CUP (Clave unica de predio):</label><input type="text" name="cup" id="cup" size="20"/>&nbsp&nbsp&nbsp&nbsp<label for="name">R20 de escritura:</label><input type="text" name="r20" id="r20" size="15"/><br/><br/>
        </div>                  
        <div class="botonesA" id="botonesA">
           <p style="text-align:right"><a href="#" class ="posicion_boton_accion_coop">Aceptar</a>&nbsp&nbsp&nbsp<a href="#" class="posicion_boton_cancelar_coop">Cancelar</a></p>                
        </div>     
     </div>
     <div id="mask"></div>
     <div id="bodegadatos"></div>
   </div>           


    <script type="text/javascript">
        /*Variables globales*/
        var accion = 'infcoop';
        var draw, select = null;


        /*Funciones para validar*/

        function checkLength(largo, n, min, max) {
            if (largo > max || largo < min) {
                updateTips("La longitud de:  " + n + " debe ser entre  " + min + " y " + max + ".");
                return false;
            } else {
                return true;
            }
        }

        function checkRegexp(o, regexp, n) {
            if (regexp.test(o)) {
                return true;
            } else {
                updateTips(n);
                return false;
            }
        }

        function checkVacio(conten, regexp, msj) {
            if (conten == "" || conten == " ") {
                return true;
            }
            else {
                return checkRegexp(conten, regexp, msj);
            }
        }

        /*Funcion para recuperar el número de la factibilidad */
        function recuperarParametro(campo) {
            var RE = new RegExp("[&?]" + campo + "=([^&]*)&");
            var href = location.href + "&";
            if (RE.test(href)) {
                RE.exec(href);
                return unescape(RegExp.$1);
            }
        }

        function updateTips(t) {
            alert(t);
        }



        function MostrarModalCoop() {
            var maskHeight = $(document).height();
            var maskWidth = $(window).width();


            //Set height and width to mask to fill up the whole screen
            $('#mask').css({ 'width': maskWidth, 'height': maskHeight });

            //transition effect             
            $('#mask').fadeIn(1000);
            $('#mask').fadeTo("slow", 0.8);

            //Get the window height and width
            var winH = $(window).height();
            var winW = $(window).width();

            //Set the popup window to center
            $("#formcoop").css('top', winH / 2 - $("#formcoop").height() / 2);
            $("#formcoop").css('left', winW / 2 - $("#formcoop").width() / 2);

            //transition effect
            $("#formcoop").fadeIn(2000);
        }





        function validarcoop() {
            var valid = checkLength($("#apaterno").val().length, "Apellino Paterno", 1, 40);            /*Valida la longitud del Apellido Paterno*/
            valid = valid && checkLength($("#amaterno").val().length, "Apellino Materno", 1, 40);            /*Valida la longitud del Apellido Materno*/
            valid = valid && checkLength($("#nombrescoop").val().length, "Nombre(s)", 1, 60);
            valid = valid && checkRegexp($("#nomfichacoop").val(), /^([ a-zA-Z0-9áéíóúüñÑÁÉÍÓÚ\.\#])+$/i, "Debes introducir nombre del cooperador");
            valid = valid && checkRegexp($("#nooficnotif").val(), /^([0-9]+)[\w-]+|(S\/N)|(s\/n)$/i, "Introduce S/N si no existe número");
            valid = valid && checkVacio($("#telcoop").val(), /^([0-9]{3})+(-){0,1}([0-9]{3})+(-){0,1}([0-9]{4})+$/i, "Introduce el teléfono correctamente");
            valid = valid && checkVacio($("#emailcoop").val(), /^[\w-+]+(\.[\w-]{1,62}){0,126}@[\w-]{1,63}(\.[\w-]{1,62})+[\w-]+$/, "Introduce dirección email correctamente ejem.: micorreo@dominio.com");
            valid = valid && checkVacio($("#curp").val(), /^([A-Z][AEIOUX][A-Z]{2}\d{2}(?:0[1-9]|1[0-2])(?:0[1-9]|[12]\d|3[01])[HM](?:AS|B[CS]|C[CLMSH]|D[FG]|G[TR]|HG|JC|M[CNS]|N[ETL]|OC|PL|Q[TR]|S[PLR]|T[CSL]|VZ|YN|ZS)[B-DF-HJ-NP-TV-Z]{3}[A-Z\d])(\d)$/, "Introduce CURP correctamente.");
            valid = valid && checkVacio($("#ctapred").val(), /^([0-9]{2})+([a-zA-Z]{1})+([a-cA-C]{1})+([0-9]{8})+$/i, "Introduce correctamente la cuenta predial");
            valid = valid && checkRegexp($("#mtsfte").val(), /^[0-9]+([.])?([0-9]+)?$/, "Introuce correctamente los metros de frente");
            valid = valid && checkRegexp($("#nooficial").val(), /^([0-9 \-a-zA-Z])|(S\/N)|(s\/n)+$/i, "999 - AAA Introduce S/N si no existe número");
            valid = valid && checkVacio($("#r20").val(), /^[\w-+]+$/i, "Introduce R20 correspondiente a la escritura");
            valid = valid && checkVacio($("#recsapal").val(), /^[\w-+]+$/i, "Introduce cuenta de SAPAL");
            valid = valid && checkVacio($("#ctaimuvi").val(), /^[\w-+]+$/i, "Introduce cuenta de imuvi");
            valid = valid && checkVacio($("#cup").val(), /^[\w-+]+$/i, "Introduce cuenta unica de predio");
            return valid;
        }




        function llenarColonias(cvesector, cvesubsector, cvecalle) {
            $.ajax({
                type: "POST",
                dataType: "json",
                contentType: "application/json",
                url: "../../WebServices/WebServiceCalCol.asmx/GetColonias",
                data: "",
                success: function (data) {
                    var elementos = 0;
                    $("#colonia").html('');
                    $(data.d).find("ColoniasDU").each(function () {
                        var option = $(document.createElement('option'));
                        var sector = $(this).find("CveSector").text();
                        var subsector = $(this).find("CveSubsector").text();
                        var colnom = $(this).find("Colonia").text();
                        option.html(colnom);
                        option.val(sector + "*" + subsector);
                        $("#colonia").append(option);
                    });
                    if (cvesector != 0) { //Si la clave de sector es diferente de 0, es decir si el registro es para editar
                        $("#colonia").val(cvesector + "*" + cvesubsector);
                    }
                    //llenarCalles((cvesector + "*" + cvesubsector), cvecalle);                        
                    llenarCalles($("#colonia").val(), cvecalle);
                },
                error: function (xhr) {
                    console.log(xhr.responseText);
                }
            });
        }

        function llenarCalles(cvecolonia, cvecallesel) {
            var arr = cvecolonia.split("*");
            var colonia = arr[0] + arr[1];
            $.ajax({
                type: "POST",
                dataType: "json",
                contentType: "application/json",
                url: "../../WebServices/WebServiceCalCol.asmx/GetCalles",
                data: "{'parametro':'" + colonia + "'}",
                success: function (data) {
                    $("#calle").html('');
                    // Data.d trae un string con el XML generado dentro del servicio web asmx
                    $(data.d).find("CallesDU").each(function () {
                        var option = $(document.createElement('option'));
                        var cvecalle = $(this).find("CveCalle").text();
                        var callenom = $(this).find("Calle").text();
                        option.html(callenom);
                        option.val(cvecalle);
                        $("#calle").append(option);
                    });
                    if (cvecallesel > 0) {
                        $("#calle").val(cvecallesel);
                    }
                },
                error: function (response) {
                    if (response.length != 0)
                        alert(response);
                }
            });
        }

        function llenarNombresCoops(cidcoop) {
            $.ajax({
                type: "POST",
                dataType: "json",
                contentType: "application/json",
                url: "../../WebServices/WebServiceCoop.asmx/GetNombresCoops",
                data: '',
                success: function (data) {
                    var elementos = 0;
                    $("#cmbNombresReg").html('');
                    $(data.d).find("NombreCoops").each(function () {
                        var option = $(document.createElement('option'));
                        var idcoop = $(this).find("mIdCoop").text();
                        var nombre = $(this).find("mNomFicha").text();
                        option.html(nombre);
                        option.val(idcoop);
                        $("#cmbNombresReg").append(option);
                    });
                    if (cidcoop != 0) { //Se pregunta si el id del cooperador es diferente de cero para la modalidad de edición y ubicar el combo en el valor que se quiere editar
                        $("#cmbNombresReg").val(cidcoop);
                    }
                },
                error: function (xhr) {
                    console.log(xhr.responseText);
                }
            });
        }



        function llenarRelPred(idrelpredio) {
            $.ajax({
                type: "POST",
                dataType: "json",
                contentType: "application/json",
                url: "../../WebServices/WebServiceRelCoopPred.asmx/ConsultaRelCoopPredio",
                data: '',
                success: function (data) {
                    var elementos = 0;
                    $("#lstrelpred").html('');
                    $(data.d).find("AllRelPred").each(function () {
                        var option = $(document.createElement('option'));
                        var idrelpred = $(this).find("cidrelpred").text();
                        var relpred = $(this).find("crelacionpredio").text();
                        option.html(relpred);
                        option.val(idrelpred);
                        $("#lstrelpred").append(option);
                    });
                    if (idrelpredio != 0) { //Se pregunta si el id del cooperador es diferente de cero para la modalidad de edición y ubicar el combo en el valor que se quiere editar
                        $("#lstrelpred").val(idrelpredio);
                    }
                },
                error: function (xhr) {
                    console.log(xhr.responseText);
                }
            });
        }

        function llenarUsoPred(idusopredio) {
            $.ajax({
                type: "POST",
                dataType: "json",
                contentType: "application/json",
                url: "../../WebServices/WebServiceUsoPredio.asmx/ConsultaUsoPredio",
                data: '',
                success: function (data) {
                    var elementos = 0;
                    $("#tipopredio").html('');
                    $(data.d).find("AllUsoPred").each(function () {
                        var option = $(document.createElement('option'));
                        var idusopred = $(this).find("cTUSueId").text();
                        var usopred = $(this).find("cTUSueNombre").text();
                        option.html(usopred);
                        option.val(idusopred);
                        $("#tipopredio").append(option);
                    });
                    if (idusopredio != 0) { //Se pregunta si el id del cooperador es diferente de cero para la modalidad de edición y ubicar el combo en el valor que se quiere editar
                        $("#tipopredio").val(idusopredio);
                    }
                },
                error: function (xhr) {
                    console.log(xhr.responseText);
                }
            });
        }




        function callWebServicePred() {
            var ctapred = $("#ctapred").val();
            if (ctapred) {
                var urlctapred = "http://201.116.205.135:8081/ccgleon/IIC/wss_DatPredial.php?sCtaPred=" + ctapred;
                try {
                    $.get(urlctapred, function (xml) {
                        xmlDoc = $.parseXML(xml),
                        $xml = $(xmlDoc),
                        $nomprop = $xml.find("NomProp");
                        $("#lblnompropmunic").text($.trim($nomprop.text()));
                        $callenotif = $xml.find("DomProp");
                        $numoficext = $xml.find("NumExtP");
                        $letraoficialext = $xml.find("LetraExtP");
                        $numoficint = $xml.find("NumIntP");
                        $colnotif = $xml.find("ColProp");
                        $usosuelo = $xml.find("TipPred");
                        $("#lblcallepropmunic").text($.trim($callenotif.text()) + " " + $.trim($numoficext.text()) + " " + $.trim($letraoficialext.text()) + " " + $.trim($numoficint.text()));
                        $("#lblcoloniamunic").text($.trim($colnotif.text()));

                        $callenumpred = $xml.find("DomPred");
                        $numoficextpred = $xml.find("NumExt");
                        $letraoficextpred = $xml.find("LetraExt");
                        $numoficintpred = $xml.find("NumInt");
                        $coloniapred = $xml.find("ColPred");

                        $("#lblmunicdomprop").text($.trim($callenumpred.text()) + ' ' + $.trim($numoficextpred.text()) + ' ' + $.trim($letraoficextpred.text()) + ' ' + $.trim($numoficintpred.text()));
                        $("#lblmuniccolprop").text($.trim($coloniapred.text()));
                        $("#tipousosuelo").text($.trim($usosuelo.text()));

                    });
                }
                catch (err) {
                    alert(err);
                }
            }
            else {
                alert("No se ha capturado ninguna cuenta predial")
            }
        }

        var misValores = {
            polygons: {
                text: 'normal',
                align: 'center',
                baseline: 'middle',
                rotation: '0',
                font: 'Arial',
                weight: 'normal',
                placement: 'point',
                maxangle: '0.7853981633974483',
                overflow: 'false',
                size: '10px',
                offsetX: '0',
                offsetY: '0',
                color: 'blue',
                outline: '#ffffff',
                outlineWidth: '3',
                maxreso: '1200'
            }
        };

        function etiqueta_predio(feature, resolution, dom) {

            var type = dom.text;
            var maxResolution = dom.maxreso;
            var text = feature.get('ctapredial');
            if (text == '' || text == null) {
                text = 'PorIdentif'
            }
            if (resolution > maxResolution) {
                text = '';
            }
            return text;
        };


        function HabilitarCajasTexto(estatus) {
            $("#cmbNombresReg").prop("disabled", estatus);
            $("#apaterno").prop("disabled", estatus);
            $("#amaterno").prop("disabled", estatus);
            $("#nombrescoop").prop("disabled", estatus);
            $("#nomfichacoop").prop("disabled", estatus);
            $("#nooficnotif").prop("disabled", estatus);
            $("#telcoop").prop("disabled", estatus);
            $("#emailcoop").prop("disabled", estatus);
            $("#curp").prop("disabled", estatus);
            $("#ctapred").prop("disabled", estatus);
            $("#mtsfte").prop("disabled", estatus);
            $("#nooficial").prop("disabled", estatus);
            $("#r20").prop("disabled", estatus);
            $("#recsapal").prop("disabled", estatus);
            $("#ctaimuvi").prop("disabled", estatus);
            $("#cup").prop("disabled", estatus);
            $("#calle").prop("disabled", estatus);
            $("#colonia").prop("disabled", estatus);
            $("#lstrelpred").prop("disabled", estatus);
            $("#tipopredio").prop("disabled", estatus);
        };





        $(document).ready(function () {  //**INICIA SCRIPT PRINCIPAL**/

            /*SECCION GLOBAL*/
            /*Codigo para controlar los eventos del clic*/
            proj4.defs("EPSG:32614", "+proj=utm +zone=14 +datum=WGS84 +units=m +no_defs");
            var SourceProjection = new proj4.Proj('EPSG:3857');
            var DestinationProjections = new proj4.Proj('EPSG:32614');

            /*proj4.defs("EPSG:32614","+proj=utm +zone=14 +datum=WGS84 +units=m +no_defs");*/
            var centro, numPredios, numFrentes, numPredAsig, numFacti;
            var x, y;
            var mapview;
            var container = document.getElementById('popup');
            var content = document.getElementById('popup-content');
            var closer = document.getElementById('popup-closer');
            var overlay = new ol.Overlay({
                element: container,
                autoPan: true,
                autoPanAnimation: {
                    duration: 250
                }
            });



            var geomfrente;
            var geompred;
            var parametro = recuperarParametro("gid"); /*Recupera valor de factibilidad*/
            var idsol = recuperarParametro("idsol"); /*Recupera valor de la solicitud*/
            var idusu = recuperarParametro("idusu"); /*Recupera valor de usuario*/
            var idanu = recuperarParametro("idanu"); /*Recupera id de anuencia*/



            $("#bodegadatos").data("idusu", idusu);

            var vectorSource = new ol.source.Vector({
                format: new ol.format.GeoJSON(),
                url: function (extent) {
                    return 'http://192.168.1.5:8090/geoserver/sigFidoc1/ows?service=WFS' +
                    '&version=1.0.0&request=GetFeature&typeName=sigFidoc1:vw_predios_fidoc' +
                    '&outputFormat=application%2Fjson&CQL_FILTER=gid=' + parametro.toString();
                }
            });

            var vectorPredFidoc = new ol.source.Vector({
                format: new ol.format.GeoJSON(),
                url: function (extent) {
                    return 'http://192.168.1.5:8090/geoserver/sigFidoc1/ows?service=WFS' +
                    '&version=1.0.0&request=GetFeature&typeName=sigFidoc1:vw_predios_fuente' +
                    '&outputFormat=application%2Fjson&CQL_FILTER=gid=' + parametro.toString();
                }
            });

            var vSourceFact = new ol.source.Vector({
                format: new ol.format.GeoJSON(),
                url: function (extent) {
                    return 'http://192.168.1.5:8090/geoserver/sigFidoc1/ows?service=WFS&' +
                         'version=1.0.0&request=GetFeature&typeName=sigFidoc1:factibilidad&' +
                         'outputFormat=application%2Fjson&CQL_FILTER=gid=' + parametro.toString();
                }

            });

            var vSourceFrentes = new ol.source.Vector({
                format: new ol.format.GeoJSON(),
                url: function (extent) {
                    return 'http://192.168.1.5:8090/geoserver/sigFidoc1/ows?service=WFS&' +
                         'version=1.0.0&request=GetFeature&typeName=sigFidoc1:frentes&' +
                         'outputFormat=application%2Fjson&CQL_FILTER=gid=' + parametro.toString();
                }
            });

            var image = new ol.style.Circle({
                radius: 5,
                fill: new ol.style.Fill({ color: 'blue' }),
                stroke: new ol.style.Stroke({ color: 'black', width: 1 })
            });

            var imageselected = new ol.style.Circle({
                radius: 4,
                fill: new ol.style.Fill({ color: 'orange' }),
                stroke: new ol.style.Stroke({ color: 'yellow', width: 1 })
            });



            /*var source = new VectorSource({ wrapX: false });*/ /*Esta línea es del ejemplo*/

            var vectorPred = new ol.layer.Vector({
                source: vectorSource,
                style: styleFunction
            });

            var vectorPredAsignados = new ol.layer.Vector({
                source: vectorSource,
                style: styleFunction
            });


            /*capa vectorial de factibilidades se configuró el propio estilo*/
            var vectorFacti = new ol.layer.Vector({
                source: vSourceFact,
                style: new ol.style.Style({
                    stroke: new ol.style.Stroke({
                        color: 'blue',
                        width: 2
                    }),
                    fill: new ol.style.Fill({
                        color: 'rgba(0, 1, 255, 0.3)'
                    })
                })
            });

            /*capa vectorial de frentes*/
            var vectorFrentes = new ol.layer.Vector({
                source: vSourceFrentes,
                style: styleFunction
            });

            /*Imagen del mapa de google*/
            var raster = new ol.layer.Tile({
                source: new ol.source.OSM()
            });


            /* Se ejecuta en el lugar 1 */
            var map = new ol.Map({
                layers: [raster, vectorFacti, vectorPredAsignados],
                target: document.getElementById('map'),
                overlays: [overlay],
                view: new ol.View({
                    center: [-11319096.234, 2406669.952],
                    maxzoom: 23,
                    zoom: 19.2
                })
            });

            /* Se ejecuta en el lugar 2 */
            vSourceFact.on('addfeature', function (evt) {
                if (vSourceFact.getState() == 'ready') {
                    var numFacti = evt.target.V.length; /*Existen poligonos de factibilidad*/
                    if (numFacti) {
                        var feature = evt.feature;
                        var coords = feature.getGeometry().getCoordinates();
                        var coord = feature.getGeometry().getExtent();
                        centro = ol.extent.getCenter(coord);
                        x = centro[0];
                        y = centro[1];
                        map.getView().setCenter(centro);
                        $('#map').css('cursor', 'wait');
                    }
                    else {
                        alert("NO SE ENCUENTRA POLIGONO DE FACTIBILIDAD.");
                        window.close();
                    }
                }
            });

            /*  vectorSource.on('addfeature', function (evt) {
                  if (vectorSource.getState() == 'ready') {
                      var numPrediosIntersectan = evt.target.V.length; /*Existen poligonos de predios que intersectan con la factibilidad*/
            /*          if (numPrediosIntersectan) {
                          $('#map').css('cursor', 'wait');                                   
                      }
                      else {
                          alert("No existen predios que se intersecten,favor de dar de alta predios");
                          window.close();
                      }
                  }
              });
   
   
              /* Se ejecuta en el lugar  3 */
            /*vectorPredAsignados.getSource().on('change', function (evt) {
                var source = evt.target;
                if (source.getState() === 'ready') {
                    numPredAsig = source.getFeatures().length;
                    if (numPredAsig) {                                                                
                        
                    }                    
                }
            });*/

            /* Se ejecuta en el lugar  3 */
            vectorPredAsignados.getSource().on('change', function (evt) {
                var source = evt.target;
                if (source.getState() === 'ready') {
                    numPredIntersect = source.getFeatures().length;
                    if (numPredIntersect) {
                        map.addLayer(vectorFrentes);
                        map.updateSize();
                    }
                    else {
                        alert("No existen predios que se intersecten,favor de dar de alta predios");
                    }
                    $('#map').css('cursor', 'login');
                }
            });



            map.on('singleclick', function (evt) {
                var geompred; //Geometría del predio
                var pid; //Id del predio
                var fid; //Id del frente
                var geomfrente; //Geometria del frente
                allFeaturesAtPixel = [];
                map.forEachFeatureAtPixel(evt.pixel, function (feature, layer) {
                    geomfrente = evt.coordinate;
                    allFeaturesAtPixel.push(feature);
                });
                if (allFeaturesAtPixel.length > 0) { //Si se encuentra features en el pixel clicado                    
                    var i;
                    for (i = 0; i < allFeaturesAtPixel.length; ++i) { //Búsqueda del feature de predio                        
                        if (allFeaturesAtPixel[i].get('fid')) {
                            fid = allFeaturesAtPixel[i].get('fid');
                        }
                        var pid = allFeaturesAtPixel[i].get('pid');
                        if (pid) {              //Si se encuentra el predio                             
                            geompred = allFeaturesAtPixel[i].getGeometry();
                            $("#bodegadatos").data("geompred", geompred);
                            $("#bodegadatos").data("pid", pid);
                            $("#bodegadatos").data("geomfrente", geomfrente);
                            break;
                        }
                    }
                    limpiarDatosCoop();
                    limpiarDatosFrente();
                    limpiarDatosPredio();
                    $("#lblsolicitud").text(idsol);
                    $("#lblfact").text(parametro);
                    $("#lblusuario").text(idusu);
                    if (accion == 'editcoop' || accion == 'elimcoop') {
                        if (fid) {

                            map.removeInteraction(select);
                            select = new ol.interaction.Select({
                                style: new ol.style.Style({
                                    image: imageselected
                                })
                            })
                            map.addInteraction(select);

                            ConsultaFrente(fid)
                           .done(function (r) {
                               var cadena = $.trim(r.d);
                               if (cadena != "<NewDataSet />") {  // Si no se encontró frente con el frente seleccionado.
                                   $(r.d).find("Frente").each(function () {
                                       $("#bodegadatos").data("fid", fid);
                                       var coorfter = $(this).find("coorfter").text();
                                       var mtsfter = parseFloat($(this).find("mtsfter").text());
                                       var cidr = parseInt($(this).find("cidr").text());
                                       var pidr = parseInt($(this).find("pidr").text());
                                       var gidr = parseInt($(this).find("gidr").text());
                                       $("#bodegadatos").data("idcoop", cidr);
                                       $("#bodegadatos").data("pid", pidr);
                                       var ctapredialr = $(this).find("ctapredial").text();
                                       var fusrcrer = parseInt($(this).find("fusrcrer").text());
                                       var ffecha_crr = ArreglaFecha($(this).find("ffecha_crr").text());
                                       var fusrmodr = parseInt($(this).find("fusrmodr").text());
                                       var ffecha_mor = ArreglaFecha($(this).find("ffecha_mor").text());
                                       $("#mtsfte").val(mtsfter);
                                       llenarNombresCoops(cidr);
                                       MostrarDatosPredio(pidr);

                                       ConsultaCoop(cidr, 'infcoop')
                                       .done(function (r) {
                                           var cadena2 = $.trim(r.d);
                                           if (cadena2 != "<NewDataSet />") {
                                               $(r.d).find("Coop").each(function () {
                                                   var apaterno = $(this).find("mApellidoP").text();
                                                   var amaterno = $(this).find("mApellidoM").text();
                                                   var nombres = $(this).find("mNombres").text();
                                                   var nomficha = $(this).find("mNomFicha").text();
                                                   var secfno = $(this).find("secfno").text();
                                                   var ssfcno = $(this).find("ssfcno").text();
                                                   var clacno = $(this).find("clacno").text();
                                                   var callecoop = parseFloat($(this).find("mCalleCoop").text());
                                                   var colcoop = parseInt($(this).find("mColCoop").text());
                                                   var nooficial = parseInt($(this).find("mNoOficial_Ext").text());
                                                   var telcoop = parseInt($(this).find("mTelCoop").text());
                                                   var curp = $(this).find("mCurp").text();
                                                   var relpredio = $(this).find("mRelacionPredio").text();
                                                   var usrcre = parseInt($(this).find("usrcre").text());
                                                   var feccre = ArreglaFecha($(this).find("feccre").text());
                                                   var usrmod = parseInt($(this).find("usrmod").text());
                                                   var fecmod = ArreglaFecha($(this).find("fecmod").text());

                                                   $("#apaterno").val(apaterno);
                                                   $("#amaterno").val(amaterno);
                                                   $("#nombrescoop").val(nombres);
                                                   $("#nomfichacoop").val(nomficha);
                                                   $("#nooficnotif").val(nooficial);
                                                   $("#telcoop").val(telcoop);
                                                   $("#emailcoop").val($(this).find("mCorreo").text());
                                                   $("#curp").val(curp);
                                                   llenarRelPred(relpredio);
                                                   llenarColonias(secfno, ssfcno, clacno);
                                               })
                                               MostrarModalCoop();
                                               if (accion == 'elimcoop') {
                                                   HabilitarCajasTexto(true);
                                                   alert('Se eliminará el frente seleccionado');
                                               }
                                           }
                                           else {
                                               alert("No se encuentra asignado algún cooperador.");
                                           }
                                       }).fail(function (r) {
                                           alert("No fué posible consultar los datos del cooperador.");
                                       })
                                   })
                               }
                               else {
                                   alert("El número de frente se encuentra vacío.");
                               }
                           }).fail(function (r) {
                               alert("No fué posible consultar el frente solicitado.");
                           });

                        }
                    }
                    if (accion == 'altacoop') { //Si la acción es para dar de alta un cooperador
                        if (geompred) { //Si existe geometria de predio                                                       
                            llenarColonias(0, 0, 0);
                            llenarNombresCoops(0);
                            llenarRelPred(0);
                            llenarUsoPred(0);
                            MostrarModalCoop();
                            MostrarDatosPredio(pid);
                        }
                        else {
                            alert("El frente no está dentro de un predio");
                            borrapuntosinregistrarseBD();
                        }
                    }
                    if (accion == 'infcoop') {
                        if (fid) {
                            ArmaVentanaCoop(fid);
                            overlay.setPosition(geomfrente);
                        }
                    }
                }

            });



            /*evento para llenar el list de calles*/

            $("#colonia").change(function () {
                llenarCalles($("#colonia").val(), 0);
            });

            $('#button').on('toolbarItemClick',
                   function (event, buttonClicked) {
                       map.removeInteraction(draw);
                       $('#map').css('cursor', 'login');
                       accion = buttonClicked.id;
                       if (accion == 'altacoop') {
                           HabilitarCajasTexto(false);
                           draw = new ol.interaction.Draw({
                               source: vSourceFrentes,
                               type: 'Point'
                           });
                           map.addInteraction(draw);
                       }
                       if (accion == 'editcoop') {
                           HabilitarCajasTexto(false);
                           $('#map').css('cursor', 'alias');

                       }
                       if (accion == 'elimcoop') {
                           $('#map').css('cursor', 'pointer');
                       }
                       if (accion == 'infcoop') {
                           $('#map').css('cursor', 'help');
                       }
                       if (accion == 'promocion') {
                           EnviarPromocion();
                           
                       }

                   });

            /*Prepara la barra de herramientas*/
            $('#button').toolbar({
                content: '#toolbar-options',
                position: 'right',
                style: 'primary',
                event: 'click',
                hideOnClick: true
            });

            $("#colnotif").change(function () {
                llenarCalles($("#colnotif").val(), 0);
            });


            closer.onclick = function () {
                overlay.setPosition(undefined);
                closer.blur();
                return false;
            };

            $(".consultarpred").click(function (e) {
                if (accion != 'elimcoop') {
                    callWebServicePred();
                }
            });

            $(".copiapeganomcoop").click(function (e) {
                if (accion != 'elimcoop') {
                    var nombrecompleto = $("#nombrescoop").val().toUpperCase() + " " + $("#apaterno").val().toUpperCase() + " " + $("#amaterno").val().toUpperCase();
                    $("#nomfichacoop").val(nombrecompleto);
                }
            });

            $(".getcoop").click(function (e) {
                if (accion != 'elimcoop') {
                    var idcoop = $("#cmbNombresReg").val();
                    $("#bodegadatos").data("idcoop", idcoop);
                    ConsultaCoop(idcoop, 'infcoop')
                                       .done(function (r) {
                                           var cadena2 = $.trim(r.d);
                                           if (cadena2 != "<NewDataSet />") {
                                               $(r.d).find("Coop").each(function () {
                                                   var apaterno = $(this).find("mApellidoP").text();
                                                   var amaterno = $(this).find("mApellidoM").text();
                                                   var nombres = $(this).find("mNombres").text();
                                                   var nomficha = $(this).find("mNomFicha").text();
                                                   var correo = $(this).find("mCorreo").text();
                                                   var secfno = $(this).find("secfno").text();
                                                   var ssfcno = $(this).find("ssfcno").text();
                                                   var clacno = $(this).find("clacno").text();
                                                   var callecoop = parseFloat($(this).find("mCalleCoop").text());
                                                   var colcoop = parseInt($(this).find("mColCoop").text());
                                                   var nooficial = parseInt($(this).find("mNoOficial_Ext").text());
                                                   var telcoop = parseInt($(this).find("mTelCoop").text());
                                                   var curp = $(this).find("mCurp").text();
                                                   var idrelpredio = $(this).find("mRelPredio").text();
                                                   var usrcre = parseInt($(this).find("usrcre").text());
                                                   var feccre = ArreglaFecha($(this).find("feccre").text());
                                                   var usrmod = parseInt($(this).find("usrmod").text());
                                                   var fecmod = ArreglaFecha($(this).find("fecmod").text());
                                                   if (secfno != '') {
                                                       $("#calle").val(clacno);
                                                   }
                                                   $("#apaterno").val(apaterno);
                                                   $("#amaterno").val(amaterno);
                                                   $("#nombrescoop").val(nombres);
                                                   $("#nomfichacoop").val(nomficha);
                                                   $("#nooficnotif").val(nooficial);
                                                   $("#telcoop").val(telcoop);
                                                   $("#emailcoop").val(correo);
                                                   $("#curp").val(curp);

                                                   llenarRelPred(idrelpredio);
                                                   llenarColonias(secfno, ssfcno, clacno)
                                               })
                                           }
                                           else {
                                               alert("El cooperador no contiene datos");
                                           }
                                       }).fail(function (r) {
                                           alert("No fue posible consultar los datos del cooperador");
                                       });
                }
            });
            /*       function barra() {
                       var progressbar = $("#progressbar"),
                         progressLabel = $(".progress-label");
           
                       progressbar.progressbar({
                           value: false,
                           change: function () {
                               progressLabel.text(progressbar.progressbar("value") + "%");
                           },
                           complete: function () {
                               progressLabel.text("Mapa completo!!");
                               $("#progressbar").hide();
           
                           }
                       });
                   }
           
                   function progress() {
                       var progressbar = $("#progressbar");
                       var val = progressbar.progressbar("value") || 0;
                       progressbar.progressbar("value", val + 1);
                       if (val < 99) {
                           setTimeout(progress, 465);
                       }          
                   }      */




            /*Codigo para mostrar el formulario modal*/

            $(".window .posicion_boton_cancelar_coop").click(function (e) {
                //Cancel the link behavior          

                /*opcion = opcion - 1;*/
                if (accion == 'altacoop') {
                    borrapuntosinregistrarseBD();
                }
                $('#mask, .window').hide();

            });

            function EnviarPromocion() {
                alert("Se regresará la solicitud a Promoción para su re-evaluación");
                SolicitaFirmas(idsol, idanu)
                        .done(function (r) {
                            alert("Reevaluar solicitud");
                            close();
                        }).fail(function (r) {
                            alert("No fué posible solicitar la re-evluación de la solicitud");
                        });
            }

            function SolicitaFirmas(idsol, idanu) {

                var usrmod = ArreglarNumUsu($("#bodegadatos").data("idusu"));
                var hoy = new Date();

                var enviarObj = {
                    "idsol": idsol,
                    "idanu": idanu,
                    "folio": '',
                    "fecentrega": hoy,
                    "fecrecibo": hoy,
                    "NomPromCalle": '',
                    "DomicProm": '',
                    "TelProm": '',
                    "PromFidoc": '',
                    "EstatusAnuencia": 2, /*Valor del estatus de la anuencia en PRESUPUESTO*/
                    "usucre": '',
                    "feccre": hoy,
                    "usumod": usrmod,
                    "fecmod": hoy,
                    "accion": '-1', /*Valor que indica la actualización del estatus de la anuencia*/
                    "docdig": ''
                }


                var stringData = JSON.stringify(enviarObj);
                return $.ajax({
                    type: 'POST',
                    url: "../../WebServices/WebServiceAnuencia.asmx/ActAnuencia",
                    data: "{objAnu:" + stringData + "}",
                    contentType: 'application/json; utf-8',
                    dataType: 'json',
                    success: function (data) {
                        if (data.d != null) {
                            alert(data.d);
                        }
                    },
                    error: function (jqXHR, textStatus, errorThrown) {
                        alert(textStatus + jqXHR + errorThrown);
                    }
                });
            }




            function HabilitarCajasTexto(estatus) {
                $("#cmbNombresReg").prop("disabled", estatus);
                $("#apaterno").prop("disabled", estatus);
                $("#amaterno").prop("disabled", estatus);
                $("#nombrescoop").prop("disabled", estatus);
                $("#nomfichacoop").prop("disabled", estatus);
                $("#nooficnotif").prop("disabled", estatus);
                $("#telcoop").prop("disabled", estatus);
                $("#emailcoop").prop("disabled", estatus);
                $("#curp").prop("disabled", estatus);
                $("#ctapred").prop("disabled", estatus);
                $("#mtsfte").prop("disabled", estatus);
                $("#nooficial").prop("disabled", estatus);
                $("#r20").prop("disabled", estatus);
                $("#recsapal").prop("disabled", estatus);
                $("#ctaimuvi").prop("disabled", estatus);
                $("#cup").prop("disabled", estatus);
                $("#calle").prop("disabled", estatus);
                $("#colonia").prop("disabled", estatus);
                $("#lstrelpred").prop("disabled", estatus);
                $("#tipopredio").prop("disabled", estatus);
            };


            $(".window .posicion_boton_accion_coop").click(function (e) {

                var fid = $("#bodegadatos").data("fid");
                var pid = $("#bodegadatos").data("pid");
                var cup = $("#cup").val();
                var fecha_cr = new Date();
                var fecha_mo = new Date();
                var usrcre = ArreglarNumUsu($("#bodegadatos").data("idusu"));
                var usrmod = ArreglarNumUsu($("#bodegadatos").data("idusu"));

                var tipo = 0;
                var tipopredio = $("#tipopredio").val();
                var ctapredial = $.trim($("#ctapred").val().toUpperCase());
                var ctaimuvi = $("#ctaimuvi").val();
                var observacio = '';
                var usopredio = $("#tipopredio").val();
                var r20 = $("#r20").val();
                var nooficial = $("#nooficial").val();
                var sapal = $("#recsapal").val();
                var geom = ''/*$("#bodegadatos").data("geompred")*/;

                if (accion != 'elimcoop') {
                    if ($.trim($("#ctapred").val()) != "") {
                        RevisaCuentaPredial(pid, cup, fecha_cr, fecha_mo, usrcre, usrmod, tipo, tipopredio, ctapredial, ctaimuvi, observacio, usopredio, r20, nooficial, sapal, geom, 'consultapredio')
                        .done(function (r) {
                            var cadena = $.trim(r.d);
                            if (cadena != "<NewDataSet />") {  // Si no se encontró predio con la cuenta predial capturada.
                                $(r.d).find("Predio").each(function () {
                                    var ctapredial = $(this).find("ctapredialr").text();
                                    var pidr = parseInt($(this).find("pidr").text());
                                    if (pid != pidr) {  // Si el predio encontrado con la cuenta predial es el mismo donde se dió clic
                                        alert("La cuenta predial: " + ctapredial + ' se encuentra registrada con el predio: ' + pidr + ' por lo tanto no es posible registrar el cooperador')
                                    }
                                    else {
                                        if (validarcoop()) {  /*Valida que los datos del cooperador sean correctos*/
                                            AsignaCoop();
                                        }
                                    }
                                })
                            }
                            else {
                                if (validarcoop()) {  /*Valida que los datos del cooperador sean correctos*/
                                    AsignaCoop();
                                }
                            }
                        }).fail(function (r) {
                            alert("No fue posible consultar la cuenta predial");
                        });
                    }
                    else {
                        var c = validarcoop();
                        if (c) {   /*Valida que los datos del cooperador sean correctos*/
                            AsignaCoop();
                        }
                    }

                }
                else {
                    EliminarFrente(fid, usrcre);
                }
                map.updateSize();
            });



            function styles(feature, resolution, dom) {
                var tipogeom = feature.getGeometry().getType();
                var stylegral = {
                    'Point': new ol.style.Style({
                        image: image
                    }),
                    'LineString': new ol.style.Style({
                        stroke: new ol.style.Stroke({
                            color: 'green',
                            width: 1
                        })
                    }),
                    'MultiLineString': new ol.style.Style({
                        stroke: new ol.style.Stroke({
                            color: 'green',
                            width: 1
                        })
                    }),
                    'MultiPoint': new ol.style.Style({
                        image: image
                    }),
                    'MultiPolygon': new ol.style.Style({
                        stroke: new ol.style.Stroke({
                            color: 'red',
                            width: 0.8
                        }),
                        fill: new ol.style.Fill({
                            color: 'rgba(102, 0, 102, 0.5)'
                        }),
                        text: new ol.style.Text({
                            textAlign: dom.align == '' ? undefined : dom.align,
                            textBaseline: dom.baseline,
                            font: dom.weight + ' ' + dom.size + ' ' + dom.font,
                            text: etiqueta_predio(feature, resolution, dom),
                            fill: new ol.style.Fill({ color: dom.color }),
                            offsetX: dom.offsetX,
                            offsetY: dom.offsetY,
                            stroke: new ol.style.Stroke({
                                color: '#fff',
                                width: 2
                            }),
                            placement: dom.placement ? dom.placement : undefined,
                            maxAngle: dom.maxangle ? parseFloat(dom.maxangle) : undefined,
                            overflow: dom.overflow ? (dom.overflow == 'true') : undefined,
                            rotation: parseFloat(dom.rotation)
                        })
                    }),
                    'Polygon': new ol.style.Style({
                        stroke: new ol.style.Stroke({
                            color: 'blue',
                            lineDash: [4],
                            width: 3
                        }),
                        fill: new ol.style.Fill({
                            color: 'rgba(0, 0, 255, 0.1)'
                        })
                    }),
                    'GeometryCollection': new ol.style.Style({
                        stroke: new ol.style.Stroke({
                            color: 'magenta',
                            width: 2
                        }),
                        fill: new ol.style.Fill({
                            color: 'magenta'
                        }),
                        image: new ol.style.Circle({
                            radius: 10,
                            fill: null,
                            stroke: new ol.style.Stroke({
                                color: 'magenta'
                            })
                        })
                    }),
                    'Circle': new ol.style.Style({
                        stroke: new ol.style.Stroke({
                            color: 'red',
                            width: 2
                        }),
                        fill: new ol.style.Fill({
                            color: 'brown'
                        })
                    })
                }
                return stylegral[tipogeom];
            };

            function styleFunction(feature, resolution) {
                return styles(feature, resolution, misValores.polygons);
            }

            function ArreglaFecha(fecha) {
                var arrfecha = fecha.split("T");
                return arrfecha[0];
            }

            function EliminarFrente(fid, usrcre) {
                $('#mask, .window').hide();
                AccionFrente(fid, 0, 0, 0, 0, '', 0, 0, '', 0, '', usrcre, '', usrcre, accion) //*Tener cuidado ya que elimina fisicamente el registro.
                .done(function (r) {
                    var features = vSourceFrentes.getFeatures();
                    for (var i = 0; i < (features.length - 1) ; i++) {
                        if (features[i].get('fid') == fid) {
                            break;
                        }
                    }
                    vSourceFrentes.removeFeature(features[i])
                    alert("Frente eliminado correctamente")
                }).fail(function (response) {
                    alert("El frente no se ha podido eliminar");
                });
            }


            function ArmaVentanaCoop(fid) {
                var coorfter;
                var mtsfter;
                var cidr;
                var pidr;
                var gidr;

                var fusrcrer;
                var ffecha_crr;
                var fusrmodr;
                var ffecha_mor;

                var cupr;
                var ctapredialr;
                var ctaimuvir;
                var usopredior;
                var r20r;
                var nooficialr;
                var sapalr;
                var coorpredr;

                var pusrcrer;
                var pfecha_crr;
                var pusrmodr;
                var pfecha_mor;
                var nomprop = '', callenotif, letraoficialext, numoficint, colnotif, usosuelo, callenumpred, numoficext, numoficextpred, letraoficextpred, numoficintpred, coloniapred, domanuencia = '', dompredio = '', domnotific = '', numoficnotif, numoficpredio;

                var nomficha;
                var callecoop;
                var colcoop;
                var nooficial;
                var telcoop;
                var relpredio;
                var usrcre;
                var feccre;
                var usrmod;
                var fecmod;


                ConsultaFrente(fid)
                    .done(function (r) {
                        $(r.d).find("Frente").each(function () {
                            coorfter = $(this).find("coorfter").text();
                            mtsfter = parseFloat($(this).find("mtsfter").text());
                            cidr = parseInt($(this).find("cidr").text());
                            pidr = parseInt($(this).find("pidr").text());
                            gidr = parseInt($(this).find("gidr").text());

                            fusrcrer = parseInt($(this).find("fusrcrer").text());
                            ffecha_crr = ArreglaFecha($(this).find("ffecha_crr").text());
                            fusrmodr = parseInt($(this).find("fusrmodr").text());
                            ffecha_mor = ArreglaFecha($(this).find("ffecha_mor").text());

                            cupr = $(this).find("cupr").text();
                            ctapredialr = $(this).find("ctapredialr").text();
                            ctaimuvir = $(this).find("ctaimuvir").text();
                            usopredior = $(this).find("usopredior").text();
                            r20r = $(this).find("r20r").text();
                            nooficialr = $(this).find("nooficialr").text();
                            sapalr = $(this).find("sapalr").text();
                            coorpredr = $(this).find("coorpredr").text();

                            pusrcrer = parseInt($(this).find("fusrcrer").text());
                            pfecha_crr = ArreglaFecha($(this).find("ffecha_crr").text());
                            pusrmodr = parseInt($(this).find("fusrmodr").text());
                            pfecha_mor = ArreglaFecha($(this).find("ffecha_mor").text());

                            ConsultaCoop(cidr, 'infcoop')
                           .done(function (r) {
                               $(r.d).find("Coop").each(function () {
                                   nomficha = $(this).find("mNomFicha").text();
                                   callecoop = $(this).find("mCalleCoop").text();
                                   colcoop = $(this).find("mColCoop").text();
                                   nooficial = $(this).find("mNoOficial_Ext").text();
                                   telcoop = $(this).find("mTelCoop").text();
                                   relpredio = $(this).find("mRelPred").text();
                                   usrcre = parseInt($(this).find("usrcre").text());
                                   feccre = ArreglaFecha($(this).find("feccre").text());
                                   usrmod = parseInt($(this).find("usrmod").text());
                                   fecmod = ArreglaFecha($(this).find("fecmod").text());
                                   domanuencia = callecoop + ' ' + nooficial + ' ' + colcoop;

                                   if (ctapredialr) {
                                       var ctapredial, nomprop, dompred, domprop, manzana, lote, tipopred;
                                       ConsultaPredial(ctapredialr)
                                       .done(function (xml) {
                                           ctapredial = $.trim($("CtaPred", xml).text());
                                           if (ctapredial) {
                                               nomprop = $.trim($("NomProp", xml).text());
                                               dompred = 'Calle: ' + $.trim($("DomPred", xml).text()) + ' ' + $.trim($("NumExt", xml).text()) + ' ' + $.trim($("LetraExt", xml).text()) + ' ' + $.trim($("NumInt", xml).text()) + ' Colonia: ' + $.trim($("ColPred", xml).text());
                                               domprop = 'Calle: ' + $.trim($("DomProp", xml).text()) + ' ' + $.trim($("NumExtP", xml).text()) + ' ' + $.trim($("LetraExtP", xml).text()) + ' ' + $.trim($("NumIntP", xml).text()) + ' Colonia: ' + $.trim($("ColProp", xml).text());
                                               manzana = $.trim($("Manzana", xml).text());
                                               lote = $.trim($("Lote", xml).text());
                                               tipopred = $.trim($("TipPred", xml).text());
                                               content.innerHTML = '<table class="letratabla"><tr><th>Metros</th><th>CoopID</th><th>pID</th><th>fID</th></tr>'
                                                                 + '<tr><td>' + mtsfter + '</td><td>' + cidr + '</td><td>' + pidr + '</td><td>' + fid + '<td></tr>'
                                                                 + '<tr><th colspan=4>DATOS DEL COOPERADOR</th></tr>'
                                                                 + '<tr><td colspan=2>Cooperador:</td><td colspan=2>' + nomficha + '</td><td>'
                                                                 + '<tr><td colspan=2>Domic. Coop (FIDOC):</td><td colspan=2>' + domanuencia + '</td><td>'
                                                                 + '<tr><td colspan=2>Tel:</td><td colspan=2>' + telcoop + '</td><td>'
                                                                 + '<tr><td colspan=2>Relación cooperador:</td><td colspan=2>' + relpredio + '</td><td>'
                                                                 + '<tr><th colspan=4>DATOS DEL PREDIO</th></tr>'
                                                                 + '<tr><td colspan=2>Uso_Predio (FIDOC):</td><td colspan=2>' + usopredior + '</td><td>'
                                                                 + '<tr><td colspan=2>Propietario:</td><td colspan=2>' + nomprop + '</td><td>'
                                                                 + '<tr><td colspan=2>Cta_Predial:</td><td colspan=2>' + ctapredial + '</td><td>'
                                                                 + '<tr><td colspan=2>Domic. Predio</td><td colspan=2>' + dompred + '</td><td>'
                                                                 + '<tr><td colspan=2>Domic. Prop.</td><td colspan=2>' + domprop + '</td><td>'
                                                                 + '<tr><td colspan=2>Manzana:</td><td colspan=2>' + manzana + '</td><td>'
                                                                 + '<tr><td colspan=2>Lote:</td><td colspan=2>' + lote + '</td><td>'
                                                                 + '<tr><td colspan=2>Uso predio (PREDIAL):</td><td colspan=2>' + tipopred + '</td><td>'
                                                                 + '<tr><td colspan=2>No. Oficial:</td><td colspan=2>' + nooficialr + '</td><td>'
                                                                 + '<tr><td colspan=2>CUP:</td><td colspan=2>' + cupr + '</td><td>'
                                                                 + '<tr><td colspan=2>CTA_IMUVI:</td><td colspan=2>' + ctaimuvir + '</td><td>'
                                                                 + '<tr><td colspan=2>R20:</td><td colspan=2>' + r20r + '</td><td>'
                                                                 + '<tr><td colspan=2>Cta. SAPAL:</td><td colspan=2>' + sapalr + '</td><td>'
                                                                 + '</table>'
                                           }
                                           else {
                                               alert("No se encontró la cuenta predial solicitada");
                                           }
                                       })
                                       .fail(function (r) {
                                           alert("No pudieron consultarse los datos de predial");
                                       });
                                   }
                                   else {

                                       content.innerHTML = '<table class="letratabla"><tr><th>Metros</th><th>CoopID</th><th>pID</th><th>fID</th></tr>'
                                                                 + '<tr><td>' + mtsfter + '</td><td>' + cidr + '</td><td>' + pidr + '</td><td>' + fid + '<td></tr>'
                                                                 + '<tr><th colspan=4>DATOS DEL COOPERADOR</th></tr>'
                                                                 + '<tr><td colspan=2>Cooperador:</td><td colspan=2>' + nomficha + '</td><td>'
                                                                 + '<tr><td colspan=2>Domic. Coop (FIDOC):</td><td colspan=2>' + domanuencia + '</td><td>'
                                                                 + '<tr><td colspan=2>Tel:</td><td colspan=2>' + telcoop + '</td><td>'
                                                                 + '<tr><td colspan=2>Relación cooperador:</td><td colspan=2>' + relpredio + '</td><td>'
                                                                 + '<tr><th colspan=4>DATOS DEL PREDIO</th></tr>'
                                                                 + '<tr><td colspan=2>Uso_Predio (FIDOC):</td><td colspan=2>' + usopredior + '</td><td>'
                                                                 + '<tr><td colspan=2>No. Oficial:</td><td colspan=2>' + nooficialr + '</td><td>'
                                                                 + '<tr><td colspan=2>CUP:</td><td colspan=2>' + cupr + '</td><td>'
                                                                 + '<tr><td colspan=2>CTA_IMUVI:</td><td colspan=2>' + ctaimuvir + '</td><td>'
                                                                 + '<tr><td colspan=2>R20:</td><td colspan=2>' + r20r + '</td><td>'
                                                                 + '<tr><td colspan=2>Cta. SAPAL:</td><td colspan=2>' + sapalr + '</td><td>'
                                                                 + '</table>'


                                   }
                               })
                           }).fail(function (r) {
                               alert("No fue posible consultar los datos del cooperador");
                           })
                        })
                    }).fail(function (r) {
                        alert("No fue posible consultar los datos del frente");
                    });
            }



            function ArreglarNumUsu(idusu) {
                var arr = idusu.split("#");
                return arr[0];
            }

            function ConsultaPredial(ctapredial) {
                var urlctapred = "http://201.116.205.135:8081/ccgleon/IIC/wss_DatPredial.php?sCtaPred=" + ctapredial;
                var text;
                return $.ajax({
                    url: urlctapred,
                    type: "GET",
                    dataType: "xml"
                });
            }

            function ConsultaFrente(fid) {
                var enviarObj = {
                    "fid": fid,
                    "accion": accion
                }

                var stringData = JSON.stringify(enviarObj);

                return $.ajax({
                    type: "POST",
                    dataType: "json",
                    contentType: "application/json",
                    url: "../../WebServices/WebServiceFrente.asmx/GetFrente",
                    data: "{objFrente:" + stringData + "}"
                });
            }

            function ConsultaCoop(idcoop, accionx) {
                var enviarObj = {
                    "idcoop": idcoop,
                    "accion": accionx
                }

                var stringData = JSON.stringify(enviarObj);

                return $.ajax({
                    type: 'POST',
                    dataType: 'json',
                    contentType: 'application/json; utf-8',
                    url: "../../WebServices/WebServiceCoop.asmx/GetCoop",
                    data: "{objCoop:" + stringData + "}"
                });
            }

            function RecargaCapaFrentes() {
                var url = 'http://localhost:8080/geoserver/sigFidoc/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=sigFidoc%3Afrentes&maxFeatures=50&outputFormat=application%2Fjson&CQL_FILTER=gid=' + parametro.toString();

                return $.ajax({
                    url: url,
                    dataType: 'json',
                    error: function (xhr) {
                        alert(xhr.statusText);
                    }

                });

            }


            function AsignaCoop() {
                //*Datos del cooperador
                var idcoop = $("#bodegadatos").data("idcoop");
                var apaterno = $("#apaterno").val();
                var amaterno = $("#amaterno").val();
                var nombres = $("#nombrescoop").val();
                var callecoop = $("#calle option:selected").text();
                var colcoop = $("#colonia option:selected").text();
                var nooficialext = $("#nooficnotif").val();
                var nooficialint = $("#nooficnotif").val();
                var telcoop = $("#telcoop").val();
                var nomficha = $("#nomfichacoop").val();
                var estado = 'GTO';
                var pais = 'MEXICO';
                var domcoop = 'Calle: ' + $.trim(callecoop) + ' No.' + $.trim(nooficialext) + ' Colonia:' + $.trim(colcoop);
                var email = $("#emailcoop").val();
                var sifidoc = '';
                var usuario = ArreglarNumUsu($("#bodegadatos").data("idusu"));
                var hoy = new Date();
                var curp = $("#curp").val();
                var relpred = parseInt($("#lstrelpred").val());
                var arrcolonia = $("#colonia").val();
                var cvecolonia = arrcolonia.split("*");
                var secfno = parseInt(cvecolonia[0]);
                var sscfno = parseInt(cvecolonia[1]);
                var cvecalle = parseInt($("#calle").val());

                //*Datos del frente*/
                var fid = $("#bodegadatos").data("fid");
                var mtsfte = parseFloat($("#mtsfte").val());
                var geompred = $("#bodegadatos").data("geompred");
                /*var lonlat = ol.proj.transform(geomcoop, 'EPSG:3857', 'EPSG:32614');*/
                var geomcoop = $("#bodegadatos").data("geomfrente");
                var pointOrigen = { x: geomcoop[0], y: geomcoop[1] };
                var pointReproyected = proj4(SourceProjection, DestinationProjections, pointOrigen);
                var longitud = pointReproyected.x;
                var latitud = pointReproyected.y;
                var gid = parseInt(parametro);
                var msgresultCoop;
                var txtidcoopr;


                //*Datos del predio*/
                var pid = $("#bodegadatos").data("pid");
                var cup = $("#cup").val();
                var tipo = 0;
                var tipopredio = $("#tipopredio").val();
                var ctapredial = $.trim($("#ctapred").val().toUpperCase());
                var ctaimuvi = $("#ctaimuvi").val();
                var observacio = '';
                var usopredio = $("#tipopredio").val();
                var r20 = $("#r20").val();
                var nooficial = $("#nooficial").val();
                var sapal = $("#recsapal").val();
                var geompredio = ''/*$("#bodegadatos").data("geompred")*/;


                if (accion == 'altacoop') {
                    estanu = 5;
                    InsertarCoop(idcoop, apaterno, amaterno, nombres, callecoop, colcoop, nooficialext, nooficialint, telcoop, nomficha, estado, pais, domcoop, email, sifidoc, usuario, hoy, usuario, hoy, curp, relpred, secfno, sscfno, cvecalle, accion)
                        .done(function (r) {
                            msgresultCoop = r.d;
                            msgresultCoop = msgresultCoop.split(":");
                            txtidcoopr = msgresultCoop[1];
                            idcoopr = parseInt(msgresultCoop[1]);
                            ActualizaPredio(pid, cup, hoy, hoy, usuario, usuario, tipo, tipopredio, ctapredial, ctaimuvi, observacio, usopredio, r20, nooficial, sapal, geompredio, accion)
                              .done(function (r) {
                                  AccionFrente(0, latitud, longitud, mtsfte, idcoopr, txtidcoopr, pid, 0, '', gid, hoy, usuario, hoy, usuario, accion)
                                  .done(function (r) {
                                      console.log("Se guardó el frente");
                                      RecargaCapaFrentes()
                                      .done(function (result) {
                                          var format = vSourceFrentes.getFormat();
                                          vSourceFrentes.forEachFeature(function (feature) {
                                              vSourceFrentes.removeFeature(feature);
                                          });
                                          var features = format.readFeatures(result);
                                          vSourceFrentes.addFeatures(features);
                                      }).fail(function (response) {
                                          alert("Error")
                                      })
                                  })
                                  .fail(function (x) {
                                      alert("No fué posible guardar los datos del frente");
                                  })
                              })
                              .fail(function (x) {
                                  alert("ISAUL");
                              })
                        })
                      .fail(function (x) {
                          alert("No fué posible guardar los datos del cooperador...");
                      });
                    $('#mask, .window').hide();
                }

                if (accion == 'editcoop') {
                    InsertarCoop(idcoop, apaterno, amaterno, nombres, callecoop, colcoop, nooficialext, nooficialint, telcoop, nomficha, estado, pais, domcoop, email, sifidoc, usuario, hoy, usuario, hoy, curp, relpred, secfno, sscfno, cvecalle, 'altacoop')
                        .done(function (r) {
                            msgresultCoop = r.d;
                            msgresultCoop = msgresultCoop.split(":");
                            txtidcoopr = msgresultCoop[1];
                            idcoopr = parseInt(msgresultCoop[1]);
                            ActualizaPredio(pid, cup, hoy, hoy, usuario, usuario, tipo, tipopredio, ctapredial, ctaimuvi, observacio, usopredio, r20, nooficial, sapal, geompredio, accion)
                              .done(function (r) {
                                  AccionFrente(fid, latitud, longitud, mtsfte, idcoopr, txtidcoopr, pid, 0, '', gid, hoy, usuario, hoy, usuario, accion)
                                  .done(function (r) {
                                      console.log("Se guardó el frente")
                                  })
                                  .fail(function (x) {
                                      alert("No fué posible guardar los datos del frente")
                                  })
                              })
                              .fail(function (x) {

                              })
                        })
                      .fail(function (x) {
                          alert("No fué posible guardar los datos del cooperador...");
                      });
                    $('#mask, .window').hide();
                }

            }


            //if mask is clicked
            $('#mask').click(function () {
                if (accion == 'altacoop') {
                    borrapuntosinregistrarseBD();
                }
                $(this).hide();
                $('.window').hide();
            });


            function borrapuntosinregistrarseBD() {
                var features = vSourceFrentes.getFeatures();
                var fid;
                for (var i = 0; i < (features.length - 1) ; i++) {
                    fid = features[i].get('fid');
                    if (!fid) {
                        break;
                    }
                }
                vSourceFrentes.removeFeature(features[i]);
                map.updateSize();
            }


            function ActualizaPredio(pid, cup, fecha_cr, fecha_mo, usrcre, usrmod, tipo, tipopredio, ctapredial, ctaimuvi, observacio, usopredio, r20, nooficial, sapal, geom, accion) {
                var enviarObj = {
                    "pid": pid,
                    "cup": cup,
                    "fecha_cr": fecha_cr,
                    "fecha_mo": fecha_mo,
                    "usrcre": usrcre,
                    "usrmod": usrmod,
                    "tipo": tipo,
                    "tipopredio": tipopredio,
                    "ctapredial": ctapredial,
                    "ctaimuvi": ctaimuvi,
                    "observacio": observacio,
                    "usopredio": usopredio,
                    "r20": r20,
                    "nooficial": nooficial,
                    "sapal": sapal,
                    "geom": geom,
                    "accion": accion
                }

                var stringData = JSON.stringify(enviarObj);

                return $.ajax({
                    type: "POST",
                    dataType: "json",
                    contentType: "application/json",
                    url: "../../WebServices/WebServicePredio.asmx/GetPredio",
                    data: "{objPredio:" + stringData + "}"
                });
            }




            function AccionFrente(fid, latitud, longitud, mts, cid, coopid, pid, oid, obrafidoc, gid, feccre, usucre, fecmod, usrmod, accion) { /*Inserta los registros de los documentos en la tabla de mDocumento*/
                var enviarObj = {
                    "fid": fid,
                    "latitud": latitud,
                    "longitud": longitud,
                    "mts": mts,
                    "cid": cid,
                    "coopid": coopid,
                    "pid": pid,
                    "oid": oid,
                    "obrafidoc": obrafidoc,
                    "gid": gid,
                    "feccre": feccre,
                    "usucre": usucre,
                    "fecmod": fecmod,
                    "usrmod": usrmod,
                    "accion": accion
                }

                var stringData = JSON.stringify(enviarObj);

                return $.ajax({
                    type: 'POST',
                    url: "../../WebServices/WebServiceFrente.asmx/ActFrente",
                    data: "{objFrente:" + stringData + "}",
                    contentType: 'application/json; utf-8',
                    dataType: 'json',
                    success: function (data) {
                        if (data.d != null) {
                            alert("Se guardó correctamente los datos del frente");
                        }
                    },
                    error: function (jqXHR, textStatus, errorThrown) {
                        alert("Existe un error");
                    }
                });
            }

            function MostrarDatosPredio(pid) {
                /*RevisaCuentaPredial(pid, cup, fecha_cr, fecha_mo, usrcre, usrmod, tipo, tipopredio, ctapredial, ctaimuvi, observacio, usopredio, r20, nooficial, sapal, geom, accion)*/
                RevisaCuentaPredial(pid, '', '', '', 1, 1, 'A', 0, '', '', '', 1, '', '', '', '', 'consultaprediopid')
                .done(function (r) {
                    $(r.d).find("Predio").each(function () {
                        var tipo_predio = parseInt($(this).find("usopredior").text());
                        $("#ctapred").val($(this).find("ctapredialr").text());
                        $("#ctaimuvi").val($(this).find("ctaimuvir").text());
                        $("#cup").val($(this).find("cupr").text());
                        $("#recsapal").val($(this).find("sapalr").text());
                        $("#nooficial").val($(this).find("nooficialr").text());
                        $("#r20").val($(this).find("r20r").text());
                        llenarUsoPred(tipo_predio);
                        if ($("#ctapred").val() != '') {
                            callWebServicePred();
                        }
                    })

                }).fail(function (r) {
                    alert("No fue posible consultar los datos del predio");
                });

            }


            function RevisaCuentaPredial(pid, cup, fecha_cr, fecha_mo, usrcre, usrmod, tipo, tipopredio, ctapredial, ctaimuvi, observacio, usopredio, r20, nooficial, sapal, geom, accion) {

                var enviarObj = {
                    "pid": pid,
                    "cup": cup,
                    "fecha_cr": fecha_cr,
                    "fecha_mo": fecha_mo,
                    "usrcre": usrcre,
                    "usrmod": usrmod,
                    "tipo": tipo,
                    "tipopredio": tipopredio,
                    "ctapredial": ctapredial,
                    "ctaimuvi": ctaimuvi,
                    "observacio": observacio,
                    "usopredio": usopredio,
                    "r20": r20,
                    "nooficial": nooficial,
                    "sapal": sapal,
                    "geom": geom,
                    "accion": accion
                }

                var stringData = JSON.stringify(enviarObj);

                return $.ajax({
                    type: "POST",
                    dataType: "json",
                    contentType: "application/json",
                    url: "../../WebServices/WebServicePredio.asmx/GetPredio",
                    data: "{objPredio:" + stringData + "}"
                });
            }



            function InsertarCoop(idcoop, apaterno, amaterno, nombres, callecoop, colcoop, nooficialext, nooficialint, telcoop, nomficha, estado, pais, domcoop, email, sifidoc, usuario, hoy, usuario, hoy, curp, relpred, secfno, sscfno, cvecalle, accion) { /*Inserta los registros de los documentos en la tabla de mDocumento*/
                var enviarObj = {
                    "idcoop": idcoop,
                    "apellidoP": apaterno,
                    "apellidoM": amaterno,
                    "nombres": nombres,
                    "callecoop": callecoop,
                    "colcoop": colcoop,
                    "nooficialext": nooficialext,
                    "nooficialint": nooficialint,
                    "telcoop": telcoop,
                    "nomficha": nomficha,
                    "pais": pais,
                    "estado": estado,
                    "dom": domcoop,
                    "correo": email,
                    "sifidoc": sifidoc,
                    "usrcre": usuario,
                    "feccre": hoy,
                    "usrmod": usuario,
                    "fecmod": hoy,
                    "curp": curp,
                    "relpred": relpred,
                    "secfno": secfno,
                    "ssfcno": sscfno,
                    "clacno": cvecalle,
                    "accion": accion
                }

                var stringData = JSON.stringify(enviarObj);

                return $.ajax({
                    type: 'POST',
                    url: "../../WebServices/WebServiceCoop.asmx/GuardarCoop",
                    data: "{objCoop:" + stringData + "}",
                    contentType: 'application/json; utf-8',
                    dataType: 'json',
                    success: function (data) {
                        if (data.d != null) {
                            alert("Se guardó correctamente los datos del cooperador");
                        }
                    },
                    error: function (jqXHR, textStatus, errorThrown) {
                    }
                });
            }

        });

    </script>
  </body>
</html>